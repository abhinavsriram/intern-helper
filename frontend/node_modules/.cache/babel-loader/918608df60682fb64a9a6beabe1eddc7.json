{"ast":null,"code":"import _classCallCheck from\"/Users/abhinavsriram/Desktop/cs0320/projects/term-project/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/abhinavsriram/Desktop/cs0320/projects/term-project/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/abhinavsriram/Desktop/cs0320/projects/term-project/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/abhinavsriram/Desktop/cs0320/projects/term-project/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import\"../styles/SignUpScreen.css\";import firebase from\"../../firebase\";import TextBox from\"../../components/src/TextBox\";import CustomButton from\"../../components/src/CustomButton\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SignUpScreen=/*#__PURE__*/function(_Component){_inherits(SignUpScreen,_Component);var _super=_createSuper(SignUpScreen);function SignUpScreen(props){var _this;_classCallCheck(this,SignUpScreen);_this=_super.call(this,props);_this.checkEmailValidity=function(){if(_this.state.email.match(\"(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\\\"(?:\"+'[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9]'+\"(?:[a-z0-9-]*[a-z0-9])?\\\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\\\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|\"+\"[1-9]?[0-9]))\\\\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\"+\"\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\\\])\")){_this.setState({emailValidityMessage:\"Your email looks valid!\"});_this.setState({emailValidityBoolean:true});_this.setState({passwordMatchMessage:\"\"});_this.setState({passwordValidityMessage:\"\"});_this.setState({errorMessage:\"\"});return true;}else{_this.setState({emailValidityMessage:\"Oops! Your email looks like it is invalid!\"});_this.setState({emailValidityBoolean:false});_this.setState({passwordMatchMessage:\"\"});_this.setState({passwordValidityMessage:\"\"});_this.setState({errorMessage:\"\"});return false;}};_this.changeEmail=function(newEmail){_this.checkEmailValidity();_this.setState({email:newEmail});};_this.checkPasswordValidity=function(){if(!!_this.state.passwordOne.match(/^(?=.*[A-Za-z])(?=.*\\d)(?=.*[$@$!%* #+=()^?&])[A-Za-z\\d$@$!%* #+=()^?&]{3,}$/)){_this.setState({passwordValidityBoolean:true});_this.setState({passwordValidityMessage:\"Your password looks secure!\"});_this.setState({passwordMatchMessage:\"\"});_this.setState({emailValidityMessage:\"\"});_this.setState({errorMessage:\"\"});return true;}else{_this.setState({passwordValidityBoolean:false});_this.setState({passwordValidityMessage:\"Oops! Password must contain at least one uppercase, one lowercase, one special character & one number!\"});_this.setState({passwordMatchMessage:\"\"});_this.setState({emailValidityMessage:\"\"});_this.setState({errorMessage:\"\"});return false;}};_this.changePasswordOne=function(newPassword){_this.checkPasswordValidity();_this.setState({passwordOne:newPassword},function(){_this.checkPasswordValidity();});};_this.checkPasswordMatch=function(){if(_this.state.passwordOne===_this.state.passwordTwo){if(_this.checkPasswordValidity()){_this.setState({passwordMatchBoolean:true});_this.setState({passwordMatchMessage:\"Passwords match!\"});_this.setState({passwordValidityMessage:\"\"});_this.setState({emailValidityMessage:\"\"});_this.setState({errorMessage:\"\"});return true;}else{_this.setState({passwordValidityBoolean:false});_this.setState({passwordValidityMessage:\"Oops! Password must contain at least one uppercase, one lowercase, one special character & one number!\"});_this.setState({passwordMatchMessage:\"\"});_this.setState({emailValidityMessage:\"\"});_this.setState({errorMessage:\"\"});return false;}}else{_this.setState({passwordMatchBoolean:false});_this.setState({passwordMatchMessage:\"Oops! Passwords don't match!\"});_this.setState({passwordValidityMessage:\"\"});_this.setState({emailValidityMessage:\"\"});_this.setState({errorMessage:\"\"});return false;}};_this.changePasswordTwo=function(newPassword){_this.checkPasswordMatch();_this.setState({passwordTwo:newPassword},function(){_this.checkPasswordMatch();});};_this.writeToDatabase=function(){firebase.firestore().collection(\"existing-users\").doc(_this.state.email).set({created_at:Date.now()}).then(function(){firebase.firestore().collection(\"user-data\").doc(_this.state.uid).set({email:_this.state.email,initial_profile_setup_complete:false}).then(function(){if(_this.state.errorMessage===\"\"){window.location.href=\"/profile1\";}}).catch(function(error){_this.setState({errorMessage:\"Oops! It looks like something went wrong. Please try again.\"});});}).catch(function(error){_this.setState({errorMessage:\"Oops! It looks like something went wrong. Please try again.\"});});};_this.createUser=function(){var email=_this.state.email;var password=_this.state.passwordTwo;firebase.auth().createUserWithEmailAndPassword(email,password).then(function(userCredential){var user=userCredential.user;_this.setState({uid:user.uid},function(){_this.writeToDatabase();});}).catch(function(error){_this.setState({errorMessage:\"Oops! It looks like something went wrong. Please try again.\"});});};_this.checkUserExists=function(){firebase.firestore().collection(\"existing-users\").doc(_this.state.email).get().then(function(doc){if(doc.exists){_this.setState({passwordMatchMessage:\"\"});_this.setState({passwordValidityMessage:\"\"});_this.setState({emailValidityMessage:\"\"});_this.setState({errorMessage:\"Oops! It looks like this email address is already in use.\"});_this.setState({errorMessageBoolean:true});}else{_this.createUser();}}).catch(function(error){_this.setState({errorMessage:\"Oops! It looks like something went wrong. Please try again.\"});});};_this.signUpClick=function(){if(_this.state.email===\"\"||_this.state.passwordOne===\"\"||_this.state.passwordTwo===\"\"){_this.setState({errorMessageBoolean:true});_this.setState({passwordMatchMessage:\"\"});_this.setState({passwordValidityMessage:\"\"});_this.setState({emailValidityMessage:\"\"});_this.setState({errorMessage:\"Oops! Please make sure all fields are filled.\"});}else if(_this.checkEmailValidity()&&_this.checkPasswordValidity()&&_this.checkPasswordMatch()){_this.checkUserExists();}else{_this.setState({errorMessageBoolean:true});_this.setState({passwordMatchMessage:\"\"});_this.setState({passwordValidityMessage:\"\"});_this.setState({emailValidityMessage:\"\"});_this.setState({errorMessage:\"Oops! Please make sure all fields are filled in correctly.\"});}};_this.goBack=function(){window.location.href=\"/landing\";};_this.state={email:\"\",passwordOne:\"\",passwordTwo:\"\",emailValidityMessage:\"\",emailValidityBoolean:true,passwordValidityMessage:\"\",passwordValidityBoolean:true,passwordMatchMessage:\"\",passwordMatchBoolean:true,errorMessage:\"\",errorMessageBoolean:false,uid:\"\"};return _this;}_createClass(SignUpScreen,[{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{className:\"main-div\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"back-button\",children:/*#__PURE__*/_jsx(CustomButton,{value:\"Go Back\",onClick:this.goBack})}),/*#__PURE__*/_jsx(\"div\",{className:\"message\",children:\"Sign Up Below\"}),/*#__PURE__*/_jsx(TextBox,{label:\"Email\",type:\"text\",value:this.state.email,change:this.changeEmail}),/*#__PURE__*/_jsx(TextBox,{label:\"Password\",type:\"password\",value:this.state.password,change:this.changePasswordOne}),/*#__PURE__*/_jsx(TextBox,{label:\"Confirm Password\",type:\"password\",value:this.state.password,change:this.changePasswordTwo}),/*#__PURE__*/_jsx(\"div\",{style:this.state.emailValidityBoolean?{color:\"green\"}:{color:\"red\"},className:\"error-messages\",children:this.state.emailValidityMessage}),/*#__PURE__*/_jsx(\"div\",{style:this.state.passwordValidityBoolean?{color:\"green\"}:{color:\"red\"},className:\"error-messages\",children:this.state.passwordValidityMessage}),/*#__PURE__*/_jsx(\"div\",{style:this.state.passwordMatchBoolean?{color:\"green\"}:{color:\"red\"},className:\"error-messages\",children:this.state.passwordMatchMessage}),/*#__PURE__*/_jsx(\"div\",{style:this.state.errorMessageBoolean?{color:\"red\"}:{color:\"green\"},className:\"error-messages\",children:this.state.errorMessage}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(CustomButton,{value:\"Sign Up\",onClick:this.signUpClick})]});}}]);return SignUpScreen;}(Component);export default SignUpScreen;","map":{"version":3,"sources":["/Users/abhinavsriram/Desktop/cs0320/projects/term-project/frontend/src/screens/src/SignUpScreen.js"],"names":["React","Component","firebase","TextBox","CustomButton","SignUpScreen","props","checkEmailValidity","state","email","match","setState","emailValidityMessage","emailValidityBoolean","passwordMatchMessage","passwordValidityMessage","errorMessage","changeEmail","newEmail","checkPasswordValidity","passwordOne","passwordValidityBoolean","changePasswordOne","newPassword","checkPasswordMatch","passwordTwo","passwordMatchBoolean","changePasswordTwo","writeToDatabase","firestore","collection","doc","set","created_at","Date","now","then","uid","initial_profile_setup_complete","window","location","href","catch","error","createUser","password","auth","createUserWithEmailAndPassword","userCredential","user","checkUserExists","get","exists","errorMessageBoolean","signUpClick","goBack","color"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"../styles/SignUpScreen.css\";\nimport firebase from \"../../firebase\";\nimport TextBox from \"../../components/src/TextBox\";\nimport CustomButton from \"../../components/src/CustomButton\";\n\nclass SignUpScreen extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      email: \"\",\n      passwordOne: \"\",\n      passwordTwo: \"\",\n      emailValidityMessage: \"\",\n      emailValidityBoolean: true,\n      passwordValidityMessage: \"\",\n      passwordValidityBoolean: true,\n      passwordMatchMessage: \"\",\n      passwordMatchBoolean: true,\n      errorMessage: \"\",\n      errorMessageBoolean: false,\n      uid: \"\",\n    };\n  }\n\n  checkEmailValidity = () => {\n    if (\n      this.state.email.match(\n        \"(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\\\"(?:\" +\n          '[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9]' +\n          \"(?:[a-z0-9-]*[a-z0-9])?\\\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\\\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|\" +\n          \"[1-9]?[0-9]))\\\\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\" +\n          \"\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\\\])\"\n      )\n    ) {\n      this.setState({ emailValidityMessage: \"Your email looks valid!\" });\n      this.setState({ emailValidityBoolean: true });\n      this.setState({ passwordMatchMessage: \"\" });\n      this.setState({ passwordValidityMessage: \"\" });\n      this.setState({ errorMessage: \"\" });\n      return true;\n    } else {\n      this.setState({\n        emailValidityMessage: \"Oops! Your email looks like it is invalid!\",\n      });\n      this.setState({ emailValidityBoolean: false });\n      this.setState({ passwordMatchMessage: \"\" });\n      this.setState({ passwordValidityMessage: \"\" });\n      this.setState({ errorMessage: \"\" });\n      return false;\n    }\n  };\n\n  changeEmail = (newEmail) => {\n    this.checkEmailValidity();\n    this.setState({ email: newEmail });\n  };\n\n  checkPasswordValidity = () => {\n    if (\n      !!this.state.passwordOne.match(\n        /^(?=.*[A-Za-z])(?=.*\\d)(?=.*[$@$!%* #+=()^?&])[A-Za-z\\d$@$!%* #+=()^?&]{3,}$/\n      )\n    ) {\n      this.setState({ passwordValidityBoolean: true });\n      this.setState({ passwordValidityMessage: \"Your password looks secure!\" });\n      this.setState({ passwordMatchMessage: \"\" });\n      this.setState({ emailValidityMessage: \"\" });\n      this.setState({ errorMessage: \"\" });\n      return true;\n    } else {\n      this.setState({ passwordValidityBoolean: false });\n      this.setState({\n        passwordValidityMessage:\n          \"Oops! Password must contain at least one uppercase, one lowercase, one special character & one number!\",\n      });\n      this.setState({ passwordMatchMessage: \"\" });\n      this.setState({ emailValidityMessage: \"\" });\n      this.setState({ errorMessage: \"\" });\n      return false;\n    }\n  };\n\n  changePasswordOne = (newPassword) => {\n    this.checkPasswordValidity();\n    this.setState({ passwordOne: newPassword }, () => {\n      this.checkPasswordValidity();\n    });\n  };\n\n  checkPasswordMatch = () => {\n    if (this.state.passwordOne === this.state.passwordTwo) {\n      if (this.checkPasswordValidity()) {\n        this.setState({ passwordMatchBoolean: true });\n        this.setState({ passwordMatchMessage: \"Passwords match!\" });\n        this.setState({ passwordValidityMessage: \"\" });\n        this.setState({ emailValidityMessage: \"\" });\n        this.setState({ errorMessage: \"\" });\n        return true;\n      } else {\n        this.setState({ passwordValidityBoolean: false });\n        this.setState({\n          passwordValidityMessage:\n            \"Oops! Password must contain at least one uppercase, one lowercase, one special character & one number!\",\n        });\n        this.setState({ passwordMatchMessage: \"\" });\n        this.setState({ emailValidityMessage: \"\" });\n        this.setState({ errorMessage: \"\" });\n        return false;\n      }\n    } else {\n      this.setState({ passwordMatchBoolean: false });\n      this.setState({ passwordMatchMessage: \"Oops! Passwords don't match!\" });\n      this.setState({ passwordValidityMessage: \"\" });\n      this.setState({ emailValidityMessage: \"\" });\n      this.setState({ errorMessage: \"\" });\n      return false;\n    }\n  };\n\n  changePasswordTwo = (newPassword) => {\n    this.checkPasswordMatch();\n    this.setState({ passwordTwo: newPassword }, () => {\n      this.checkPasswordMatch();\n    });\n  };\n\n  writeToDatabase = () => {\n    firebase\n      .firestore()\n      .collection(\"existing-users\")\n      .doc(this.state.email)\n      .set({\n        created_at: Date.now(),\n      })\n      .then(() => {\n        firebase\n          .firestore()\n          .collection(\"user-data\")\n          .doc(this.state.uid)\n          .set({\n            email: this.state.email,\n            initial_profile_setup_complete: false,\n          })\n          .then(() => {\n            if (this.state.errorMessage === \"\") {\n              window.location.href = \"/profile1\";\n            }\n          })\n          .catch((error) => {\n            this.setState({\n              errorMessage:\n                \"Oops! It looks like something went wrong. Please try again.\",\n            });\n          });\n      })\n      .catch((error) => {\n        this.setState({\n          errorMessage:\n            \"Oops! It looks like something went wrong. Please try again.\",\n        });\n      });\n  };\n\n  createUser = () => {\n    const email = this.state.email;\n    const password = this.state.passwordTwo;\n    firebase\n      .auth()\n      .createUserWithEmailAndPassword(email, password)\n      .then((userCredential) => {\n        const user = userCredential.user;\n        this.setState({ uid: user.uid }, () => {\n          this.writeToDatabase();\n        });\n      })\n      .catch((error) => {\n        this.setState({\n          errorMessage:\n            \"Oops! It looks like something went wrong. Please try again.\",\n        });\n      });\n  };\n\n  checkUserExists = () => {\n    firebase\n      .firestore()\n      .collection(\"existing-users\")\n      .doc(this.state.email)\n      .get()\n      .then((doc) => {\n        if (doc.exists) {\n          this.setState({ passwordMatchMessage: \"\" });\n          this.setState({ passwordValidityMessage: \"\" });\n          this.setState({ emailValidityMessage: \"\" });\n          this.setState({\n            errorMessage:\n              \"Oops! It looks like this email address is already in use.\",\n          });\n          this.setState({ errorMessageBoolean: true });\n        } else {\n          this.createUser();\n        }\n      })\n      .catch((error) => {\n        this.setState({\n          errorMessage:\n            \"Oops! It looks like something went wrong. Please try again.\",\n        });\n      });\n  };\n\n  signUpClick = () => {\n    if (\n      this.state.email === \"\" ||\n      this.state.passwordOne === \"\" ||\n      this.state.passwordTwo === \"\"\n    ) {\n      this.setState({ errorMessageBoolean: true });\n      this.setState({ passwordMatchMessage: \"\" });\n      this.setState({ passwordValidityMessage: \"\" });\n      this.setState({ emailValidityMessage: \"\" });\n      this.setState({\n        errorMessage: \"Oops! Please make sure all fields are filled.\",\n      });\n    } else if (\n      this.checkEmailValidity() &&\n      this.checkPasswordValidity() &&\n      this.checkPasswordMatch()\n    ) {\n      this.checkUserExists();\n    } else {\n      this.setState({ errorMessageBoolean: true });\n      this.setState({ passwordMatchMessage: \"\" });\n      this.setState({ passwordValidityMessage: \"\" });\n      this.setState({ emailValidityMessage: \"\" });\n      this.setState({\n        errorMessage:\n          \"Oops! Please make sure all fields are filled in correctly.\",\n      });\n    }\n  };\n\n  goBack = () => {\n    window.location.href = \"/landing\";\n  };\n\n  render() {\n    return (\n      <div className=\"main-div\">\n        <div className=\"back-button\">\n          <CustomButton value={\"Go Back\"} onClick={this.goBack} />\n        </div>\n        <div className=\"message\">Sign Up Below</div>\n        <TextBox\n          label={\"Email\"}\n          type={\"text\"}\n          value={this.state.email}\n          change={this.changeEmail}\n        />\n        <TextBox\n          label={\"Password\"}\n          type={\"password\"}\n          value={this.state.password}\n          change={this.changePasswordOne}\n        />\n        <TextBox\n          label={\"Confirm Password\"}\n          type={\"password\"}\n          value={this.state.password}\n          change={this.changePasswordTwo}\n        />\n        <div\n          style={\n            this.state.emailValidityBoolean\n              ? { color: \"green\" }\n              : { color: \"red\" }\n          }\n          className=\"error-messages\"\n        >\n          {this.state.emailValidityMessage}\n        </div>\n        <div\n          style={\n            this.state.passwordValidityBoolean\n              ? { color: \"green\" }\n              : { color: \"red\" }\n          }\n          className=\"error-messages\"\n        >\n          {this.state.passwordValidityMessage}\n        </div>\n        <div\n          style={\n            this.state.passwordMatchBoolean\n              ? { color: \"green\" }\n              : { color: \"red\" }\n          }\n          className=\"error-messages\"\n        >\n          {this.state.passwordMatchMessage}\n        </div>\n        <div\n          style={\n            this.state.errorMessageBoolean\n              ? { color: \"red\" }\n              : { color: \"green\" }\n          }\n          className=\"error-messages\"\n        >\n          {this.state.errorMessage}\n        </div>\n        <br />\n        <CustomButton value={\"Sign Up\"} onClick={this.signUpClick} />\n      </div>\n    );\n  }\n}\n\nexport default SignUpScreen;\n"]},"metadata":{},"sourceType":"module"}