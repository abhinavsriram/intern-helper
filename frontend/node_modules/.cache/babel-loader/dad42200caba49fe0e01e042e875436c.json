{"ast":null,"code":"var _jsxFileName = \"/Users/abhinavsriram/Desktop/cs0320/projects/term-project/frontend/src/screens/src/InternshipsForMeScreen.js\";\nimport React, { Component } from \"react\";\nimport \"../styles/InternshipsForMeScreen.css\";\nimport firebase from \"../../firebase\";\nimport BigCustomButton from \"../../components/src/BigCustomButton\";\nimport image from \"../../media/accessdenied.jpeg\";\nimport CustomButton from \"../../components/src/CustomButton\";\nimport { WaveLoading } from \"react-loadingg\";\nimport InternshipResult from \"../../components/src/InternshipResult\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass InternshipsForMeScreen extends Component {\n  constructor(props) {\n    super(props);\n\n    this.getInternships = user => {\n      firebase.firestore().collection(\"user-data\").doc(user.uid).collection(\"internships\").doc(\"Internships List\").get().then(doc => {\n        if (doc.exists) {\n          this.setState({\n            internshipsList: doc.data().internshipsList\n          }, () => {\n            for (let i = 0; i < this.state.internshipsList.length; i++) {\n              firebase.firestore().collection(\"user-data\").doc(user.uid).collection(\"internships\").doc(this.state.internshipsList[i]).get().then(doc => {\n                if (doc.exists) {\n                  this.setState(prevState => ({\n                    internships: [...prevState.internships, /*#__PURE__*/_jsxDEV(InternshipResult, {\n                      title: doc.data().title,\n                      company: doc.data().company,\n                      apply: doc.data().link,\n                      description: doc.data().description\n                    }, Math.random(), false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 48,\n                      columnNumber: 25\n                    }, this)]\n                  }));\n                }\n              }).catch(error => {\n                this.setState({\n                  errorMessage: \"Oops! It looks like something went wrong. Please try again.\"\n                });\n              });\n            }\n          });\n        }\n      }).catch(error => {\n        this.setState({\n          errorMessage: \"Oops! It looks like something went wrong. Please try again.\"\n        });\n      });\n    };\n\n    this.writeToDatabase = (id, title, company, description, link) => {\n      firebase.firestore().collection(\"user-data\").doc(this.state.uid).collection(\"internships\").doc(id).set({\n        title: title,\n        company: company,\n        description: description,\n        link: link\n      }).then(() => {}).catch(error => {\n        this.setState({\n          errorMessage: \"Oops! It looks like something went wrong. Please try again.\"\n        });\n      });\n    };\n\n    this.getResultsFromBackend = user => {\n      const toSend = {\n        id: user.uid\n      };\n      let config = {\n        headers: {\n          Accept: \"application/json\",\n          \"Access-Control-Allow-Origin\": \"*\"\n        }\n      };\n      axios.post(\"http://localhost:5100/userJobResults\", toSend, config).then(response => {\n        let localInternships = [];\n        let localInternshipsList = [];\n        Object.entries(response.data[\"userJobResults\"]).forEach(([key, value]) => {\n          let crypto = require(\"crypto-js\");\n\n          let concat = value[\"title\"] + value[\"company\"] + value[\"link\"] + value[\"requiredQualifications\"];\n          let ID = crypto.SHA256(concat).toString();\n          localInternshipsList.push(ID);\n          localInternships.push( /*#__PURE__*/_jsxDEV(InternshipResult, {\n            title: value[\"title\"],\n            company: value[\"company\"],\n            apply: value[\"link\"],\n            description: value[\"requiredQualifications\"]\n          }, Math.random(), false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 15\n          }, this));\n          this.writeToDatabase(ID, value[\"title\"], value[\"company\"], value[\"requiredQualifications\"], value[\"link\"]);\n        });\n        this.setState({\n          internships: localInternships\n        });\n        this.setState({\n          internshipsList: localInternshipsList\n        }, () => {\n          firebase.firestore().collection(\"user-data\").doc(this.state.uid).collection(\"internships\").doc(\"Internships List\").set({\n            internshipsList: this.state.internshipsList\n          }).then(() => {\n            firebase.firestore().collection(\"user-data\").doc(this.state.uid).update({\n              changed_resume: false\n            }).then(() => {}).catch(error => {\n              this.setState({\n                errorMessage: \"Oops! It looks like something went wrong. Please try again.\"\n              });\n            });\n          }).catch(error => {\n            this.setState({\n              errorMessage: \"Oops! It looks like something went wrong. Please try again.\"\n            });\n          });\n        });\n      }).catch(function (error) {\n        console.log(error);\n      });\n    };\n\n    this.getUserID = () => {\n      let authFlag = true;\n      firebase.auth().onAuthStateChanged(user => {\n        if (authFlag) {\n          authFlag = false;\n\n          if (user) {\n            firebase.firestore().collection(\"user-data\").doc(user.uid).get().then(doc => {\n              if (doc.exists) {\n                if (doc.data().changed_resume) {\n                  this.getResultsFromBackend(user);\n                } else {\n                  this.getInternships(user);\n                }\n              }\n            }).catch(error => {\n              console.log(error.message);\n            });\n            this.setState({\n              uid: user.uid\n            });\n            this.setState({\n              access: true\n            });\n          } else {\n            this.setState({\n              access: false\n            });\n          }\n        }\n      });\n    };\n\n    this.portDetermination = () => {\n      const PORT = process.env.PORT;\n      console.log(\"running on port: \" + window.location.port);\n    };\n\n    this.goBack = () => {\n      window.location.href = \"/home\";\n    };\n\n    this.state = {\n      uid: \"\",\n      access: true,\n      loading: true,\n      internships: [],\n      internshipsList: [],\n      changedResume: false\n    };\n  }\n\n  componentDidMount() {\n    this.getUserID();\n    this.portDetermination();\n    this.id = setTimeout(() => this.setState({\n      loading: false\n    }), 3000);\n  }\n\n  componentWillUnmount() {\n    clearTimeout(this.id);\n  }\n\n  render() {\n    return this.state.access ? this.state.loading ? /*#__PURE__*/_jsxDEV(WaveLoading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-div\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"back-button\",\n        children: /*#__PURE__*/_jsxDEV(CustomButton, {\n          value: \"Go Back\",\n          onClick: this.goBack\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header-int-me\",\n        children: \"Internships For Me\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 11\n      }, this), this.state.internships, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 11\n      }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 18\n      }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 25\n      }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 32\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"denied-wrapper\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: image,\n        alt: \"access denied\",\n        style: {\n          height: \"330px\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 9\n      }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 16\n      }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 23\n      }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 30\n      }, this), /*#__PURE__*/_jsxDEV(BigCustomButton, {\n        value: \"Click Here To Log In\",\n        onClick: () => {\n          window.location.href = \"/landing\";\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default InternshipsForMeScreen;","map":{"version":3,"sources":["/Users/abhinavsriram/Desktop/cs0320/projects/term-project/frontend/src/screens/src/InternshipsForMeScreen.js"],"names":["React","Component","firebase","BigCustomButton","image","CustomButton","WaveLoading","InternshipResult","axios","InternshipsForMeScreen","constructor","props","getInternships","user","firestore","collection","doc","uid","get","then","exists","setState","internshipsList","data","i","state","length","prevState","internships","title","company","link","description","Math","random","catch","error","errorMessage","writeToDatabase","id","set","getResultsFromBackend","toSend","config","headers","Accept","post","response","localInternships","localInternshipsList","Object","entries","forEach","key","value","crypto","require","concat","ID","SHA256","toString","push","update","changed_resume","console","log","getUserID","authFlag","auth","onAuthStateChanged","message","access","portDetermination","PORT","process","env","window","location","port","goBack","href","loading","changedResume","componentDidMount","setTimeout","componentWillUnmount","clearTimeout","render","height"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"../styles/InternshipsForMeScreen.css\";\nimport firebase from \"../../firebase\";\nimport BigCustomButton from \"../../components/src/BigCustomButton\";\nimport image from \"../../media/accessdenied.jpeg\";\nimport CustomButton from \"../../components/src/CustomButton\";\nimport { WaveLoading } from \"react-loadingg\";\nimport InternshipResult from \"../../components/src/InternshipResult\";\nimport axios from \"axios\";\n\nclass InternshipsForMeScreen extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      uid: \"\",\n      access: true,\n      loading: true,\n      internships: [],\n      internshipsList: [],\n      changedResume: false,\n    };\n  }\n\n  getInternships = (user) => {\n    firebase\n      .firestore()\n      .collection(\"user-data\")\n      .doc(user.uid)\n      .collection(\"internships\")\n      .doc(\"Internships List\")\n      .get()\n      .then((doc) => {\n        if (doc.exists) {\n          this.setState({ internshipsList: doc.data().internshipsList }, () => {\n            for (let i = 0; i < this.state.internshipsList.length; i++) {\n              firebase\n                .firestore()\n                .collection(\"user-data\")\n                .doc(user.uid)\n                .collection(\"internships\")\n                .doc(this.state.internshipsList[i])\n                .get()\n                .then((doc) => {\n                  if (doc.exists) {\n                    this.setState((prevState) => ({\n                      internships: [\n                        ...prevState.internships,\n                        <InternshipResult\n                          title={doc.data().title}\n                          company={doc.data().company}\n                          apply={doc.data().link}\n                          description={doc.data().description}\n                          key={Math.random()}\n                        />,\n                      ],\n                    }));\n                  }\n                })\n                .catch((error) => {\n                  this.setState({\n                    errorMessage:\n                      \"Oops! It looks like something went wrong. Please try again.\",\n                  });\n                });\n            }\n          });\n        }\n      })\n      .catch((error) => {\n        this.setState({\n          errorMessage:\n            \"Oops! It looks like something went wrong. Please try again.\",\n        });\n      });\n  };\n\n  writeToDatabase = (id, title, company, description, link) => {\n    firebase\n      .firestore()\n      .collection(\"user-data\")\n      .doc(this.state.uid)\n      .collection(\"internships\")\n      .doc(id)\n      .set({\n        title: title,\n        company: company,\n        description: description,\n        link: link,\n      })\n      .then(() => {})\n      .catch((error) => {\n        this.setState({\n          errorMessage:\n            \"Oops! It looks like something went wrong. Please try again.\",\n        });\n      });\n  };\n\n  getResultsFromBackend = (user) => {\n    const toSend = {\n      id: user.uid,\n    };\n    let config = {\n      headers: {\n        Accept: \"application/json\",\n        \"Access-Control-Allow-Origin\": \"*\",\n      },\n    };\n    axios\n      .post(\"http://localhost:5100/userJobResults\", toSend, config)\n      .then((response) => {\n        let localInternships = [];\n        let localInternshipsList = [];\n        Object.entries(response.data[\"userJobResults\"]).forEach(\n          ([key, value]) => {\n            let crypto = require(\"crypto-js\");\n            let concat =\n              value[\"title\"] +\n              value[\"company\"] +\n              value[\"link\"] +\n              value[\"requiredQualifications\"];\n            let ID = crypto.SHA256(concat).toString();\n            localInternshipsList.push(ID);\n            localInternships.push(\n              <InternshipResult\n                title={value[\"title\"]}\n                company={value[\"company\"]}\n                apply={value[\"link\"]}\n                description={value[\"requiredQualifications\"]}\n                key={Math.random()}\n              />\n            );\n            this.writeToDatabase(\n              ID,\n              value[\"title\"],\n              value[\"company\"],\n              value[\"requiredQualifications\"],\n              value[\"link\"]\n            );\n          }\n        );\n        this.setState({ internships: localInternships });\n        this.setState({ internshipsList: localInternshipsList }, () => {\n          firebase\n            .firestore()\n            .collection(\"user-data\")\n            .doc(this.state.uid)\n            .collection(\"internships\")\n            .doc(\"Internships List\")\n            .set({\n              internshipsList: this.state.internshipsList,\n            })\n            .then(() => {\n              firebase\n                .firestore()\n                .collection(\"user-data\")\n                .doc(this.state.uid)\n                .update({\n                  changed_resume: false,\n                })\n                .then(() => {})\n                .catch((error) => {\n                  this.setState({\n                    errorMessage:\n                      \"Oops! It looks like something went wrong. Please try again.\",\n                  });\n                });\n            })\n            .catch((error) => {\n              this.setState({\n                errorMessage:\n                  \"Oops! It looks like something went wrong. Please try again.\",\n              });\n            });\n        });\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  };\n\n  getUserID = () => {\n    let authFlag = true;\n    firebase.auth().onAuthStateChanged((user) => {\n      if (authFlag) {\n        authFlag = false;\n        if (user) {\n          firebase\n            .firestore()\n            .collection(\"user-data\")\n            .doc(user.uid)\n            .get()\n            .then((doc) => {\n              if (doc.exists) {\n                if (doc.data().changed_resume) {\n                  this.getResultsFromBackend(user);\n                } else {\n                  this.getInternships(user);\n                }\n              }\n            })\n            .catch((error) => {\n              console.log(error.message);\n            });\n          this.setState({ uid: user.uid });\n          this.setState({ access: true });\n        } else {\n          this.setState({ access: false });\n        }\n      }\n    });\n  };\n\n  portDetermination = () => {\n    const PORT = process.env.PORT;\n    console.log(\"running on port: \" + window.location.port)\n  }\n\n  componentDidMount() {\n    this.getUserID();\n    this.portDetermination();\n    this.id = setTimeout(() => this.setState({ loading: false }), 3000);\n  }\n\n  componentWillUnmount() {\n    clearTimeout(this.id);\n  }\n\n  goBack = () => {\n    window.location.href = \"/home\";\n  };\n\n  render() {\n    return this.state.access ? (\n      this.state.loading ? (\n        <WaveLoading />\n      ) : (\n        <div className=\"main-div\">\n          <div className=\"back-button\">\n            <CustomButton value={\"Go Back\"} onClick={this.goBack} />\n          </div>\n          <div className=\"header-int-me\">Internships For Me</div>\n          {this.state.internships}\n          <br /> <br /> <br /> <br />\n        </div>\n      )\n    ) : (\n      <div className={\"denied-wrapper\"}>\n        <img src={image} alt={\"access denied\"} style={{ height: \"330px\" }} />\n        <br /> <br /> <br /> <br />\n        <BigCustomButton\n          value={\"Click Here To Log In\"}\n          onClick={() => {\n            window.location.href = \"/landing\";\n          }}\n        />\n      </div>\n    );\n  }\n}\n\nexport default InternshipsForMeScreen;\n"]},"metadata":{},"sourceType":"module"}